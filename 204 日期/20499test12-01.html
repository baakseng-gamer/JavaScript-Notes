<script>
    function formatDate(date) {
        let diff = new Date() - date; // 以毫秒表示的差值

        if (diff < 1000) { // 少于 1 秒
            return 'right now';
        }

        let sec = Math.floor(diff / 1000); // 将 diff 转换为秒

        if (sec < 60) {
            return sec + ' sec. ago';
        }

        let min = Math.floor(diff / 60000); // 将 diff 转换为分钟
        if (min < 60) {
            return min + ' min. ago';
        }

        // 格式化 date
        // 将前置 0 加到一位数 day/month/hours/minutes 前
        let d = date;
        d = [
            '0' + d.getDate(),
            '0' + (d.getMonth() + 1),
            '' + d.getFullYear(),
            '0' + d.getHours(),
            '0' + d.getMinutes()
        ].map(component => component.slice(-2)); // 得到每个组件的后两位

        // 将时间信息和日期组合在一起
        return d.slice(0, 3).join('.') + ' ' + d.slice(3).join(':');
    }

    alert(formatDate(new Date(new Date - 1))); // "right now"

    alert(formatDate(new Date(new Date - 30 * 1000))); // "30 sec. ago"

    alert(formatDate(new Date(new Date - 5 * 60 * 1000))); // "5 min. ago"

    // 昨天的日期如：31.12.2016 20:00
    alert(formatDate(new Date(new Date - 86400 * 1000)));
</script>