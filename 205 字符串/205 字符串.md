# 205 字符串

**目录**



***

# 1. 认识字符串对象

前面有一个内容 <a href="..\111 Javascript数据类型\111 Javascript数据类型.md">111 Javascript数据类型</a> 提到的一种数据类型—— string 字符串，所有带单引号或双引号的叫做字符串。这是基本类型。

为方便操作基本数据类型，JavaScript 还提供了三个特殊的引用类型：String、Number 和 Boolean。这些的类型叫做**基本包装类型。**

**==注意==**

* 开头大写的 String、 Number 和 Boolean 是复杂数据类型；
* 开头小写的是简单数据类型。

字符串是基本类型，按照逻辑上不应该有方法， 但是 JavaScript 可以使之有方法，所以**万物皆可对象**。

示例：

```
    let myName = 'Baakseng';
    let text = myName.indexOf('k');
    console.log(myName, text); // Baakseng 3
    // Baakseng 中的 k 索引号为3
    console.log(typeof myName); // string
```

实例： [20501renshi01.html](20501renshi01.html) 

实际上，每当读取一个基本类型值的时候，**后台就会创建一个对应的基本包装类型的对象**，从而让我们能够调用一些方法来操作这些数据。

根据上面的示例执行过程如下：

```
    let myName;
    // 生成临时变量
    let tmp = new String('Baakseng');
    // 赋值给我们的字符串
    myName = tmp;
    // 销毁临时变量
    tmp = null;
    console.log(myName); // 输出结果在下面所示
    console.log(typeof myName); // object
    console.log(tmp); // null
    console.log(typeof tmp); // object
```

console.log(myName); 的输出结果：

```
String {"Baakseng"}
0: "B"
1: "a"
2: "a"
3: "k"
4: "s"
5: "e"
6: "n"
7: "g"
length: 8
__proto__: String
[[PrimitiveValue]]: "Baakseng"
```

实例： [20501renshi02.html](20501renshi02.html) 

数字第0位是"B"，第1位是"a"，它的 length 属性是8，即8个字符。它的默认值是 "Baakseng"，它的原型 (proto) 是 String 这个类。前面有个一段话：**JS中的万物皆可对象**，字符串型 string 是字符串引用类型 String 中的一员，是会继承字符串引用类型的所有属性。好比人属于人类中的一员，人会继承人类的所有特征一样。

点击 "proto" 原型，可查看它继承 String 哪些方法，下图所示可展示全部方法：

![20501](img/20501.png)

```
    let myName = new String('Baakseng');
    console.log(myName.__proto__); // String
    console.log(myName.__proto__.__proto__); // Object
    console.log(myName.__proto__.__proto__.__proto__); // null
```

这个方法的原型，指向了 Function 的 prototype （注意constructor这个属性,默认会指向Function本身），再次打开proto，会打开继承的Object这个基本引用类型；之所以说是基本引用类型，是因为Object.proto是null，已经到顶了。

我们从里面选一个方法 indexOf()，看看这个方法用途是什么：

```
    let test1 = myName.indexOf('B');
    let test2 = myName.__proto__.indexOf('B');
    console.log(test1); // 0
    console.log(test2); // -1
```

indexOf() 这个方法就是括号里的字符在哪个索引号。'B' 在第0位，所以输出是0。

实例： [20501renshi03.html](20501renshi03.html) 

如果使用下面就不行了，会报错，因为 .proto.proto里面并没有 indexOf() 这个方法。

```
let test3 = myName.__proto__.__proto__.indexOf('B'); // is not a function 
```

基本包装类型的简单讲解就到这一步，后面会单独一个内容做笔记了解基本包装类型。



# 2. 声明

字符串声明有以下几个方法：

* 通过 new 运算符声明字符串；
* 省略 new 声明字符串；
* 字符串字面量赋值。 

```
    let str1 = new String('GP01');
    let str2 = String('GP02');
    let str3 = 'GP03';

    console.log(str1, typeof str1); // String {"GP01"} object
    console.log(str2, typeof str2); // GP02 string
    console.log(str3, typeof str3); // GP03 string
```

实例： [20502shengming01.html](20502shengming01.html) 

当 String() 和 new 运算符一起作为构造函数使用时，它返回一个新创建的String对象,存放的是字符串s或s的字符串表示。
当不用new运算符调用String()是，它只把s转换成原始的字符串，并返回转换后的值。



字符串的执行图解：

```
    let str1 = 'Baakseng';
    let str2 = str1;
    console.log(str1, str2); // Baakseng Baakseng
```

![20502](img/20502.png)

字符串被创建时会放进 只读的数据段，当用 str1 赋值给 str2 时，'Baakseng' 会从只读段赋值给 str2。

实例： [20502shengming02.html](20502shengming02.html) 



# 3. length

每个 String 对象都有 length 属性，表示字符串中的字符数量。看下面的示例：

```
    let str = new String('Baakseng');
    let howLength = str.length;
    console.log(str.length); // 8
    console.log(howLength); // 8
```

有8个字符。

实例： [20503length01.html](20503length01.html) 



如果是汉字呢？

```
    let myName = '黎柏成';
    console.log(myName.length); // 3 
```

一个汉字算一个字符。

实例： [20503length02.html](20503length02.html) 



其它各种汉英、空格、标点符号、空字符等等示例：

```
    let str1 = '中文english';
    console.log(str1.length); // 9 一个汉字一个字符
    
    let str2 = 'hi!,.';
    console.log(str2.length); // 一个标点符号一个字符

    let str3 = ' '; // 一个空格
    let str4 = '  '; // 两个空格
    console.log(str3.length, str4.length); // 1 2 一个空格一个字符

    let str5 = '';
    console.log(str5.length); // 0 无内容就是零个字符

    let str6 = 'Hi! L叔。，';
    console.log(str6.length); // 8 一个中文标点符号一个字符
```

实例： [20503length03.html](20503length03.html) 

**==注==**

* 中文：utf-8（三个字符表示一个汉字），gbk（两个字符表示一个汉字）。



# 4. 字符串的不可变

在 JavaScript 中，字符串是只读的，意味着字符串一旦创建就不能被修改。

看下面示例：

```
    let str = 'abc';
    console.log(str[0]); // a
    // 尝试修改 str 的内容
    str[0] = 'd';
    console.log(str[0]); // a
```

无法更改字符串内容。

实例： [20504zhidu01.html](20504zhidu01.html) 

如果重新给变量 str 赋值新的字符串呢？

```
    let str = 'abc';
    console.log(str, str[0]); // abc a

    str = 'def';
    console.log(str, str[0]); // def d
```

虽然变量 str 能被重新赋值新的字符串，但是 常量 'abc' 依然在内存中。

实例： [20504zhidu02.html](20504zhidu02.html) 

重新给字符串赋值，会重新在内存中开辟空间，这个特点就是字符串的不可变。由于这个特点，在大量拼接字符串的时候会有效率问题。

```
    let start = Date.now();
    let str = '';
    for(let i = 0; i < 100000; i++){
        str += i;
    }
    console.log(str);
    let end = Date.now();
    console.log(end - start); // 24毫秒
```

实例： [20504zhidu03.html](20504zhidu03.html) 



# 5. 可遍历字符串

可通过循环进行遍历字符串。

示例：

```
    let str = '不动明王阵';
    for(let i = 0; i < str.length; i++){
        document.write(str[i] + '<br />');
    }
    // 不
	// 动
	// 明
	// 王
	// 阵
```

实例： [20505bianli01.html](20505bianli01.html) 

输出第 偶数 位的字符串：

```
    let str = '霜之哀伤火之高兴';
    for(let i = 0; i < str.length; i += 2){
        document.write(str[i]);
    }
    // 霜哀火高
```

实例： [20505bianli02.html](20505bianli02.html) 



# 6. 获取字符

有个方法可以根据位置获取字符串中的字符。

| 方法                    | 功能                                                         |
| ----------------------- | ------------------------------------------------------------ |
| charAt(索引值)          | 返回指定索引位置的字符                                       |
| charCodeAt(索引值)      | 返回指定索引位置字符的 UTF-16 单元表示的 Unicode 值          |
| str[索引值]             | str 为声明字符串的变量，返回指定索引位置的字符，与 charAt() 等效 |
| fromCharCode(Unicode值) | 返回由指定的 UTF-16 代码单元序列创建的字符串。               |

* 有个教程说的 charCodeAt() 返回的是 ASCII 码。可我查 MDN 和 W3School 提的是 Unicode 码。先不管，后面再了解了解。



## 6.1 charAt(index)

返回指定位置的字符，index 参数为字符中的下标（索引值），若括号里无参数，则默认为0。

示例：

```
    let myName = 'Baakseng';
    let s1 = myName.charAt(0);

    console.log(s1); // B B在索引值1的位置
    console.log(myName.charAt(2)); // a a在索引值2的位置
    console.log(myName.charAt(1, 3)); // a 参数只能1个，以最左为准
    console.log(myName.charAt()); // B 括号内无参数，则默认0
```

实例： [20506huoqu01.html](20506huoqu01.html) 



## 6.2 charCodeAt(index)

返回指定位置的字符的 Unicode 编码，括号里的参数作用和上面一样。

示例：

```
    let myName = 'Baakseng';
    console.log(myName.charCodeAt(0)); // 66 B的 Unicode 值为66
    console.log(myName.charCodeAt(1)); // 97 a的 Unicode 值为97

    console.log(myName.charCodeAt(1, 3)); // 97 只能获取括号内最左边的

    console.log(myName.charCodeAt()); // 66 括号内无参数，默认0索引的字符的 U 编码
```

实例： [20506huoqu02.html](20506huoqu02.html) 



## 6.3 string[index]

string 为声明字符串的变量，返回指定索引位置的字符，与 charAt() 等效。

示例：

```
    let myName = 'Baakseng';
    console.log(myName[0]); // B
    console.log(myName[0, 1]); // a 只能获取最右边的

    // console.log(myName[]); 
    // Uncaught SyntaxError: Unexpected token ']' 
    // [] 内无参数，则出错 不能空的
```

实例： [20506huoqu03.html](20506huoqu03.html) 



## 6.4 fromCodeChar(index)

返回由指定的 UTF-16 代码单元序列创建的字符串，index 参数为 Unicode 编码，参数可多个。

示例：

```
    let myName = String.fromCharCode(66, 97, 97, 107, 115, 101, 110, 103);
    console.log(myName); // Baakseng
    console.log(typeof myName); // string
```

实例： [20506huoqu04.html](20506huoqu04.html) 

fromCodeChar() 其实是一个创建字符串的方法，和 charAt() 不一样的。

网上有 Unicode 编码表 可参考，也有在线转换工具使用。



## 6.5 超出范围

比如，能显示 Baakseng 的索引值范围为 0 到 7，如果索引为 8 会输出什么样的？

```
    let myName = 'Baakseng';
    console.log(myName[8]); // undefined
    console.log(myName[100]); // undefined
    console.log(myName.charAt(8)); //  空字符
    console.log(myName.charCodeAt(8)); // NaN
```

实例：  [20506huoqu05.html](20506huoqu05.html) 

索引值为负数：

```
    let myName = 'Baakseng';
    console.log(myName[-1]); // undefined
    console.log(myName.charAt(-1)); //  空字符
    console.log(myName.charCodeAt(-1)); // NaN
```

情况和上面的超出范围示例一样。

实例： [20506huoqu03.html](20506huoqu03.html) 



超出范围情况总结：

* 不使用方法，myName[超出范围]，输出为 undefined。
* charAt() 索引值超出范围，返回空字符串。
* charCodeAt() 索引值超出范围，返回 NaN。



# 7. 位置方法（重点）

根据字符返回其所在字符串中首次出现的索引号。

## 7.1 indexOf()

格式：indexOf('要查找的字符', 开始的位置)，如果不设开始的位置，默认为 0 。示例：

```
    let person = 'Baakseng';
    let weizhi = person.indexOf('k', 0);
    console.log(weizhi); // 3 k 在索引号3的位置
    console.log(person.indexOf('e')); // 5 无位置的参数，即默认从0开始

    let str1 = 'abcdabcd';

    console.log(str1.indexOf('a', 0)); // 0
    // a在索引号0的位置，只能显示首次出现的

    console.log(str1.indexOf('a', 2)); // 4 
    // 从索引号2开始寻找字符 a 的位置，首次出现在4的位置
```

实例： [20507weizhi01.html](20507weizhi01.html) 

如果没有找到会返回什么：

```
    let str1 = 'abc';
    console.log(str1.indexOf('d', 0)); // -1
    // 没有找到返回 -1
```

实例： [20507weizhi02.html](20507weizhi02.html) 





# 练习

**1.最多的字符**

判断一个字符串 'abcoefoxyozzopp' 中出现次数最多的字符，并统计其次数。



**2.“abaasdffggghhjjkkgfddsssss3444343”**

1. 字符串的长度；
2. 取出指定位置的字符，如：0,3,5,9等；
3. 查找指定字符是否在以上字符串中存在，如：i，c ，b等；
4. 替换指定的字符，如：g替换为22,ss替换为b等操作方法；
5. 截取指定开始位置到结束位置的字符串，如：取得1-5的字符串；
6. 找出以上字符串中出现次数最多的字符和出现的次数 ；
7. 遍历字符串，并将遍历出的字符两头添加符号“@”；

***

**以下为现代 JS 的练习**

**3.首字母大写**

写一个函数 ucFirst(str)，并返回首字母大写的字符串 str，例如：

```
ucFirst("john") == "John";
```



**4.检查 spam**

写一个函数 checkSpam(str)，如果 str 包含 viagra 或 XXX 就返回 true，否则返回 false。
函数必须不区分大小写：

```
checkSpam('buy ViAgRA now') == true
checkSpam('free xxxxx') == true
checkSpam("innocent rabbit") == false
```



**5.截断文本**

创建函数 truncate(str, maxlength) 来检查 str 的长度，如果超过 maxlength —— 应使用 "…" 来代替 str 的结尾部分，长度仍然等于 maxlength。
函数的结果应该是截断后的文本（如果需要的话）。
例如：

```
truncate("What I'd like to tell on this topic is:", 20) = "What I'd like to te…"

truncate("Hi everyone!", 20) = "Hi everyone!"
```



**6.提取货币**

我们有以 "$120" 这样的格式表示的花销。意味着：先是美元符号，然后才是数值。
创建函数 extractCurrencyValue(str) 从字符串中提取数值并返回。
例如：

```
alert( extractCurrencyValue('$120') === 120 ); // true
```



***

**以下为千锋的练习或作业**

**7.敏感词**

![20503](img/20503.png)



**8.拼接**

已知有两个字符串 str1 = ‘hello’ str2 = ‘world’，将两个拼接。



**9.找出范围**

已知字符串  str = “I love BeiJing”,找出love的范围。



**10.从范围提取**

已知字符串 str = “I hate BeiJing!”，提取第3个字符到第5个字符。



**11.生成新字符串**

将字符串 str = “When I was young, I love a girl in neighbor class.” 中，从 young 提取到 girl 生成新字符串。但是不许数。



**12.空格隔开**

将字符中单词用空格隔开，已知传入的字符串中只有字母,每个单词的首字母大写，请将每个单词用空格隔开，只保留一个单词的首字母大写。

传入：”HelloMyWorld”
返回：”Hello my world”



**13.验证码（四位）**

有两种方式。



**14.倒序**

将字符串按照单词进行逆序，空格作为划分单词的唯一条件。

传入："Welcome to Beijing”
返回："Beijing to Welcome”



**15.对称数组**

传入一个数组，起元素类型与个数皆未知，返回新数组，由原数组的元素正序反序拼接而成。

传入：["One", "Two", "Three"]

返回：["One", "Two", "Three", "Three", "Two", "One"]



**16.非字母分割**

已知一个字符串对象中,英语单词用各种非字母字符分割，统计单词个数。

传入：”Yes, she*is%my@love.”;
返回：5



**17.出现次数**

实现函数，查找子串出现的次数，返回字符串str中出现substring的次数。

传入：”abcabcabc”, “abc”

返回：3



**18.判断邮箱**

已知千锋邮箱的用户名只能由数字字母下划线组成，域名为@1000phone.com，判断一个字符串是否是千锋邮箱，是返回true，不是返回false。

```
mail@1000phone.com   是
$mail@1000phone.com  不是
mail@1000phone.comp  不是
```



**19.获取值**

```
https://www.baidu.com/s?name=avery&age=20&sex=male
```

取出 name、age 和 sex 的值。



20.